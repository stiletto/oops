CC = @CC@
LIBS = @LIBS@
CFLAGS = @CFLAGS@
SOFLAGS = @SOFLAGS@
OPT_MODS = @OPT_MODS@

.SUFFIXES:	.c .so

.c.so:
	${CC} ${CFLAGS} ${CDEFS} $(SOFLAGS) $(LIBS) $< -o $@

all:	log_dummy.so err.so passwd_file.so lang.so redir.so oopsctl_mod.so oopsctl \
	vary_header.so accel.so $(OPT_MODS)

log_dummy.so:	log_dummy.c ../modules.h ../oops.h
	${CC} ${CFLAGS} ${CDEFS} $(SOFLAGS) $(LIBS) log_dummy.c -o log_dummy.so

err.so:	err.c ../modules.h ../oops.h
	${CC} ${CFLAGS} ${CDEFS} $(SOFLAGS) $(LIBS) err.c -o err.so

lang.so:	lang.c ../modules.h ../oops.h
	${CC} ${CFLAGS} ${CDEFS} $(SOFLAGS) $(LIBS) lang.c -o lang.so

oopsctl_mod.so:	oopsctl_mod.c ../modules.h ../oops.h
	${CC} ${CFLAGS} ${CDEFS} $(SOFLAGS) $(LIBS) oopsctl_mod.c -o oopsctl_mod.so

oopsctl: oopsctl.c ../modules.h ../config.h  ../oops.h
	${CC} ${CFLAGS} ${CDEFS} oopsctl.c $(LIBS) -o oopsctl

passwd_file.so:	passwd_file.c ../modules.h ../oops.h
	${CC} ${CFLAGS} ${CDEFS} $(SOFLAGS) $(LIBS) passwd_file.c -o passwd_file.so

redir.so:	redir.c ../modules.h ../oops.h
	${CC} ${CFLAGS} ${CDEFS} $(SOFLAGS) $(LIBS) redir.c -o redir.so

vary_header.so: vary_header.c ../modules.h ../oops.h
	${CC} ${CFLAGS} ${CDEFS} $(SOFLAGS) $(LIBS) vary_header.c -o vary_header.so

clean:
	rm -f *\.so

